---
import Layout from '@/layouts/Layout.astro';
import { Phone } from '@/components/Phone';
import { SignedIn, SignedOut, SignIn, UserButton } from '@clerk/astro/components';
import StillProgress from '@/components/astro/StillProgress.astro';
const user = await Astro.locals.currentUser();
---

<Layout>
  <Phone client:only='react' user={user} />
  <StillProgress />


  <aside class='signin-modal'>
    <SignedOut>
      <SignIn />
    </SignedOut>
  </aside>

  <aside class='logout-container'>
    <SignedIn>
      <UserButton />
    </SignedIn>
  </aside>
</Layout>

<style>
  .signin-modal {
    position: absolute;
    right: 0;
    bottom: 0;
    zoom: 0.05;
    z-index: -1;
    overflow: hidden;
    opacity: 0;

    .cl-signIn-root {
      transform: translateY(90%);
    }
  }

  .logout-container {
    position: absolute;
    background-color: red;
    top: 0;
    right: 0;
    zoom: 0.005;
    opacity: 0;

    * {
      zoom: 0.005;
      opacity: 0;
    }
  }

  /* Reset PopoverCard */
  :global(.cl-userButtonPopoverCard) {
    top: 6vmax !important;
    right: 5vmax !important;
    width: 19vmax;
    max-width: calc(-2vmax + 100vw);
    border-radius: 0.5vmax;
    zoom: 0.0001;
    opacity: 0;
    box-shadow:
      rgba(0, 0, 0, 0.08) 0px 0.325vmax 1vmax 0px,
      rgba(25, 28, 33, 0.2) 0px 0.975vmax 2.3vmax -0.325vmax,
      rgba(0, 0, 0, 0.07) 0px 0px 0px 0.06vmax;

    @media (width <= 900px) {
      width: 15vmax;
    }

    * {
      font-family: 'Open Sans';
      font-size: 0.9vmax;
    }

    div.cl-userButtonPopoverMain {
      --offset: 0.0052vmax;
      border-radius: 0vmax;
      box-shadow:
        rgba(0, 0, 0, 0.08) 0px 0px 0.125vmax 0px,
        rgba(25, 28, 33, 0.06) 0px 0.065vmax 0.125vmax 0px,
        rgba(0, 0, 0, 0.03) 0px 0px 0px 0.0625vmax;

      span.cl-userPreview {
        gap: 1.04vmax;
        padding: 1.04vmax 1.3vmax;

        span.cl-userPreviewAvatarContainer {
          span.cl-avatarBox {
            width: 2.44vmax;
            height: 2.44vmax;

            img.cl-avatarImage {
            }
            span.cl-internal-gpirto {
            }
          }
        }

        span.cl-userPreviewTextContainer {
          span.cl-userPreviewMainIdentifier {
            gap: 0.16vmax;

            span.cl-internal-3gh7hq {
            }
          }

          span.cl-userPreviewSecondaryIdentifier {
          }
        }
      }

      div.cl-userButtonPopoverActions {
        border-top: 0.06vmax solid rgba(0, 0, 0, 0.07);

        button.cl-userButtonPopoverActionButton {
          border-width: 0.00065vmax 0px 0px;

          gap: 0.5vmax;
          padding: 1vmax;
          padding-left: 1.5vmax;

          span.cl-userButtonPopoverActionButtonIconBox {
            flex: 0 0 0.145vmax;
            gap: 2vmax;

            svg {
              width: 1.6vmax;
              height: 1.6vmax;
            }
          }
        }
      }
    }

    .cl-userButtonPopoverFooter {
      &.cl-internal-d50gl1 {
        .cl-internal-1hp5nqm {
          padding: 1.04vmax 2.08vmax;

          .cl-internal-piyvrh {
          }

          .cl-internal-df7v37 {
            gap: 0.52vmax;

            .cl-internal-y44tp9 {
              .cl-internal-16mc20d {
                gap: 0.26vmax;

                p.cl-internal-wf8x4b {
                  font-size: 0.9vmax;
                }

                a.cl-internal-1fcj7sw {
                  svg {
                    width: 3.12vmax;
                    height: 0.92vmax;
                  }
                }
              }
            }

            p.cl-internal-16vtwdp {
              display: none !important;
            }
          }
        }
      }
    }
  }
</style>
